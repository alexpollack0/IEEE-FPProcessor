`timescale 1ns / 1ps

module WallaceTree(
    input [24:0] p0, 
    input [24:0] p1,
    input [24:0] p2,
    input [24:0] p3,
    input [24:0] p4,
    input [24:0] p5,
    input [24:0] p6,
    input [24:0] p7,
    input [24:0] p8,
    input [24:0] p9,
    input [24:0] p10,
    input [24:0] p11,
    input [24:0] p12,
    input [24:0] p13,
    input [24:0] p14,
    input [24:0] p15,
    output [56:0] s
    );
    
    assign s[1:0] = p0[1:0];
    
    wire [25:0] s00;
    wire [26:0] c00;
    
    CSA #(.SIZE(27)) csa00(.X({{4{p0[24]}},p0[24:2]}), .Y({{2{p1[24]}},p1}), .Z({p2,2'b0}), .PS({s00,s[2]}), .SC(c00));
    
    wire [28:0] s01;
    wire [26:0] c01;
    
    assign s01[1:0] = p3[1:0];
    
    CSA #(.SIZE(27)) csa01(.X({{4{p3[24]}},p3[24:2]}), .Y({{2{p4[24]}},p4}), .Z({p5,2'b0}), .PS(s01[28:2]), .SC(c01));
    
    wire [28:0] s02;
    wire [26:0] c02;
    
    assign s02[1:0] = p6[1:0];
    
    CSA #(.SIZE(27)) csa02(.X({{4{p6[24]}},p6[24:2]}), .Y({{2{p7[24]}},p7}), .Z({p8,2'b0}), .PS(s02[28:2]), .SC(c02));
    
    wire [28:0] s03;
    wire [26:0] c03;
    
    assign s03[1:0] = p9[1:0];
    
    CSA #(.SIZE(27)) csa03(.X({{4{p9[24]}},p9[24:2]}), .Y({{2{p10[24]}},p10}), .Z({p11,2'b0}), .PS(s03[28:2]), .SC(c03));
    
    wire [28:0] s04;
    wire [26:0] c04;
    
    assign s04[1:0] = p12[1:0];
    
    CSA #(.SIZE(27)) csa04(.X({{4{p12[24]}},p12[24:2]}), .Y({{2{p13[24]}},p13}), .Z({p14,2'b0}), .PS(s04[28:2]), .SC(c04));
    
    wire [30:0] s10;
    wire [31:0] c10;
    
    CSA #(.SIZE(32)) csa10(.X({{6{s00[25]}},s00}), .Y({{5{c00[25]}},c00}), .Z({s01,3'b0}), .PS({s10,s[3]}), .SC(c10));
    
    wire [32:0] s11;
    wire [29:0] c11;
    
    assign s11[2:0] = c01[2:0];
    
    CSA #(.SIZE(30)) csa11(.X({{6{c01[26]}},c01}), .Y({s02[28],s02}), .Z({c02,3'b0}), .PS(s11[32:3]), .SC(c11));
    
    wire [34:0] s12;
    wire [31:0] c12;
    
    assign s12[2:0] = s03[2:0];
    
    CSA #(.SIZE(32)) csa12(.X({{6{s03[28]}},s03[28:3]}), .Y({{5{c03[26]}},c03}), .Z({s04,3'b0}), .PS(s12[34:3]), .SC(c12));
    
    wire [36:0] s20;
    wire [37:0] c20;
        
    CSA #(.SIZE(38)) csa20(.X({{7{s10[30]}},s10}), .Y({{6{c10[31]}},c10}), .Z({s11,5'b0}), .PS({s20,s[4]}), .SC(c20));
    
    wire [41:0] s21;
    wire [35:0] c21;
    
    assign s21[5:0] = c11[5:0];
    
    CSA #(.SIZE(36)) csa21(.X({{11{c11[29]}},c11[29:6]}), .Y({s12[34],s12}), .Z({c12,4'b0}), .PS(s21[41:6]), .SC(c21));
    
    wire [47:0] s30;
    wire [48:0] c30;
    
    CSA #(.SIZE(49)) csa30(.X({{12{s20[26]}},s20}), .Y({{11{c20[37]}},c20}), .Z({s21,7'b0}), .PS({s30,s[5]}), .SC(c30));
    
    wire [35:0] s31;
    wire [27:0] c31;
    
    assign s31[7:0] = c21[7:0];
    
    CSA #(.SIZE(28)) csa31(.X(c21[35:8]), .Y({c04[26],c04}), .Z({p15,1'b0}), .PS(s31[35:8]), .SC(c31));
    
    wire [47:0] s40;
    wire [48:0] c40;
    
    CSA #(.SIZE(49)) csa40(.X({s30[47],s30}), .Y(c30), .Z({s31,13'b0}), .PS({s40,s[6]}), .SC(c40));
    
    wire [47:0] s50;
    wire [48:0] c50;
    
    CSA #(.SIZE(49)) csa50(.X({s40[47],s40}), .Y(c40), .Z({c31,21'b0}), .PS({s50,s[7]}), .SC(c50));
    
    CLA49 cla (.a({s50[47],s50}), .b(c50), .s(s[51:8]));
    
endmodule
